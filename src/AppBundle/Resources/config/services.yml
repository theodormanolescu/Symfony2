imports:
    - { resource: listeners.yml }
    - { resource: events.xml }
services:
    app.listener.soft_delete:
        class: AppBundle\Event\Listener\SoftDelete
        tags:
            - { name: doctrine.event_listener, event: onFlush }
    
    app.doctrine_aware:
        class: AppBundle\Service\AbstractDoctrineAware
        arguments: [@doctrine, @logger, @event_dispatcher]
        abstract: true
        
    app.warehouse:
        class: AppBundle\Service\WarehouseService
        parent: app.doctrine_aware
        tags:
            - {name: json_rpc.service, method: getAll}
    app.catalog:
        class: AppBundle\Service\CatalogService
        parent: app.doctrine_aware

    app.order:
        class: AppBundle\Service\OrderService
        parent: app.doctrine_aware
        tags:
            - {name: json_rpc.service, method: createOrder}
        order:
            alias: app.order
        warehouse:
            alias: app.warehouse
    app.email:
        class: AppBundle\Service\EmailService
        calls: #The following should be on one line, I split it here for readability
        - ["addProvider", ["@=service('kernel').getEnvironment() === 'dev' ? service('app.provider_email_dev') : service('app.provider_email_php')"]]